!function(e){var t=function(e,t){return function(){e.call(this),this.fields={feedbackText:{type:"string",name:"feedbackText",validators:["presence"],validateFail:{presence:"请用简洁明了的文字说明用一下您要反馈的意见"}},feedbackTextImg1:{type:"string",name:"feedbackTextImg1"},feedbackTextImg2:{type:"string",name:"feedbackTextImg2"},feedbackTextImg3:{type:"string",name:"feedbackTextImg3"}},this.formElement=document.querySelector("#feedbackForm"),this.setFeedbackTextImgVal=function(e,t){this["setFeedbackTextImg"+(e+1)+"Val"](t)},this.setFeedbackTextImg1Val=function(e){document.querySelector("#feedbackTextImg1").value=e},this.setFeedbackTextImg2Val=function(e){document.querySelector("#feedbackTextImg2").value=e},this.setFeedbackTextImg3Val=function(e){document.querySelector("#feedbackTextImg3").value=e},this.setMethod=function(e){this.method=e},this.method="feedbackSubmit"}}(e),n=function(){var e=this;this.container=document.querySelector("#feedbackImgContainer"),this.containerLists=this.container.children,this.inputfiles=this.container.getElementsByTagName("input"),this.labelImages=this.container.getElementsByTagName("img"),this.setContainerListsandLabelSize=function(){for(var e=this.containerLists,t=0;t<e.length;t++){var n=e[t].clientWidth+"px";e[t].style.height=n;var i=e[t].getElementsByTagName("label")[0];i.style.height=n,i.style.width=n}},this.resetImageView=function(e,t){},this.init=function(){e.setContainerListsandLabelSize(),window.addEventListener("resize",function(t){t||window.event;e.setContainerListsandLabelSize()})}},i=function(){this.fileInputContainer=new n,this.getFormAction=function(){return document.querySelector("#feedbackFor").action},this.renderLoadResult=function(e,t){this.fileInputContainer.labelImages[e].src=t},this.focusFeedbackText=function(){document.querySelector("#feedbackText").focus()},this.showLoading=function(){},this.closeLoading=function(){},this.init=function(){this.fileInputContainer.init()}},a=function(){var e=this,n=new i,a=n.getFormAction(),s=new t;s.setMethod(a),this.resize=function(e,t){var i=e.index;n.showLoading(i);lrz(e.files[0],{width:800}).then(function(e){return n.renderLoadResult(i,e.base64),s.setFeedbackTextImgVal(i,e.base64),e})["catch"](function(e){alert(e)}).always(function(){n.closeLoading(i)})},this.closePage=function(){},this.submitSucess=function(t){"ok"==t.isOk?(alert("提交成功，谢谢反馈"),e.closePage()):alert(t.errMsg)},this.validatorError=function(e){var t=s.getValidateFailMsg(e).join(" , ");alert(t),n.focusFeedbackText()},this.submitFeedBack=function(t){s.post(e.submitSucess,e.validatorError)},this.init=function(){n.init();for(var t=n.fileInputContainer.inputfiles,i=0;i<t.length;i++)t[i].index=i,t[i].addEventListener("change",function(t){t||window.event;e.resize(this,t)});document.querySelector("#feedbackFormBtn").onclick=function(t){e.submitFeedBack(t||window.event)}}},s=new a;s.init()}(BaseForm);